'''
Task Introduction:
From the following website, I download DBS history share prices into a CSV file.
https://sg.finance.yahoo.com/quote/D05.SI/history/
What is a CSV file?
CSV stands for Comma-Separated Values file. In each row, all values are separated by comma.
And the whole file looks like a table which contains columns and rows.
What does the data in our csv file mean?
Let's look at some sample data of the csv file:
Date,Open,High,Low,Close,Volume
2021-01-12,26.790001,26.860001,26.520000,26.730000,4847200
2021-01-13,27.000000,27.100000,26.719999,26.760000,3740200
2021-01-14,26.900000,26.990000,26.770000,26.990000,2521200
The 1st row is the Title row, it tells you the meaning of columns of the Data rows.
All the rows after 1st row are Data rows.
Singapore Exchange Market opens from Monday to Friday. Each day, trading hour is 9am - 5pm.
2021-01-14 is Thursday.
On 9am, DBS share price was 26.9 SGD/share. This price is called OPEN price.
During the whole day, people buy and sell DBS shares, and the price fluctuated up and down during the whole day.
Till 5pm, when the Singapore Exchange Market closed, the last trading price was 26.99 SGD/share. This price is called CLOSE price.
And during this whole day, when the price went down, the lowest point is 26.77 SGD/share. This price is called LOW price.
When the price went up, the highest point is 26.99 SGD/share. This price is called HIGH price.
You can see the HIGH price is the CLOSE price as well, which means, the market is quite optimistic.
The last column is 'Volume', which means how many shares have been bought/sold on the day.
Total amount traded on Jan 14th is: (Let's use CLOSE price for a ballpark estimation)
2,521,200 shares * 26.99 SGD/share = 68,072,400 SGD, that's about 68 million SGD traded on the day.
Here is the chart:
https://sg.finance.yahoo.com/quote/D05.SI/chart?p=D05.SI
Mr Fan has done the labour work to copy part of the data from csv file to our python program.
'''

# Step 1) Define a nested list which holds all DBS history prices from 2019-01-01 till 2021-01-14
# trade_data is list of day_trade_data
# day_trade_data is a list which hold trade_date / OPEN / HIGH / LOW / CLOSE / VOLUME info of the trading day.
#     Date,     Open,   High,  Low,Close, Volume
trade_data = [
    [20190101, 23.69, 23.69, 23.69, 20.95, 0],
    [20190102, 23.76, 23.87, 23.26, 20.77, 2737613],
    [20190103, 23.27, 23.41, 23.03, 20.41, 5214000],
    [20190104, 22.83, 23.29, 22.8, 20.59, 3905000],
    [20190107, 23.74, 23.8, 23.54, 21.0, 3629832],
    [20190108, 23.86, 23.96, 23.74, 21.14, 3119900],
    [20190109, 24.0, 24.25, 24.0, 21.43, 4113000],
    [20190110, 24.25, 24.46, 24.13, 21.61, 3889500],
    [20190111, 24.64, 24.82, 24.58, 21.91, 3829900],
    [20190114, 24.89, 24.89, 24.5, 21.72, 2289600],
    [20190115, 24.8, 25.09, 24.76, 22.12, 4161500],
    [20190116, 25.09, 25.2, 24.92, 22.25, 3980700],
    [20190117, 25.16, 25.19, 24.91, 22.17, 2666500],
    [20190118, 25.17, 25.25, 25.04, 22.23, 2482600],
    [20190121, 25.2, 25.3, 25.01, 22.11, 2496400],
    [20190122, 24.9, 24.94, 24.55, 21.71, 3149300],
    [20190123, 24.46, 24.49, 24.11, 21.36, 4914200],
    [20190124, 24.03, 24.25, 24.03, 21.4, 2778333],
    [20190125, 24.25, 24.42, 24.22, 21.41, 2708200],
    [20190128, 24.27, 24.4, 24.2, 21.41, 2492300],
    [20190129, 24.21, 24.27, 24.03, 21.41, 3245200],
    [20190130, 24.25, 24.25, 23.94, 21.17, 4043700],
    [20190131, 24.2, 24.23, 23.86, 21.15, 5572800],
    [20190201, 24.0, 24.13, 23.9, 21.28, 2744500],
    [20190204, 24.12, 24.26, 24.08, 21.38, 1911800],
    [20190205, 24.18, 24.18, 24.18, 21.38, 0],
    [20190207, 24.25, 24.46, 24.16, 21.51, 3196900],
    [20190208, 24.2, 24.42, 24.13, 21.48, 2766386],
    [20190211, 24.01, 24.44, 24.01, 21.54, 3230000],
    [20190212, 24.39, 24.41, 24.28, 21.52, 2678500],
    [20190213, 24.58, 24.9, 24.53, 22.01, 5086200],
    [20190214, 24.78, 24.97, 24.78, 22.08, 4105200],
    [20190215, 24.88, 24.99, 24.63, 21.92, 4885800],
    [20190218, 25.0, 25.29, 24.89, 22.28, 5147100],
    [20190219, 25.22, 25.33, 25.1, 22.19, 3293078],
    [20190220, 25.23, 25.3, 25.05, 22.17, 3509000],
    [20190221, 24.81, 25.0, 24.7, 21.94, 5993300],
    [20190222, 24.7, 25.07, 24.7, 22.11, 4219570],
    [20190225, 25.0, 25.25, 24.94, 22.26, 3049000],
    [20190226, 25.26, 25.26, 24.98, 22.25, 3196800],
    [20190227, 25.05, 25.4, 25.02, 22.24, 3894500],
    [20190228, 25.25, 25.25, 24.84, 21.96, 5343600],
    [20190301, 24.97, 25.22, 24.93, 22.17, 2153700],
    [20190304, 25.11, 25.5, 25.11, 22.55, 4796803],
    [20190305, 25.35, 25.45, 25.24, 22.48, 2834400],
    [20190306, 25.3, 25.54, 25.21, 22.42, 2994400],
    [20190307, 25.37, 25.5, 25.27, 22.39, 2928900],
    [20190308, 25.05, 25.22, 25.02, 22.16, 4123900],
    [20190311, 25.05, 25.18, 25.01, 22.21, 2090400],
    [20190312, 25.3, 25.47, 25.26, 22.37, 3163400],
    [20190313, 25.17, 25.18, 24.92, 22.08, 4532600],
    [20190314, 24.95, 25.23, 24.88, 22.19, 2734000],
    [20190315, 25.01, 25.38, 24.97, 22.23, 5238000],
    [20190318, 25.35, 25.41, 25.14, 22.32, 2109300],
    [20190319, 25.29, 25.43, 25.25, 22.47, 2600000],
    [20190320, 25.34, 25.43, 25.19, 22.41, 2678400],
    [20190321, 25.48, 25.49, 25.37, 22.45, 2881800],
    [20190322, 25.4, 25.45, 25.22, 22.41, 2454900],
    [20190325, 24.94, 25.12, 24.75, 22.21, 5722100],
    [20190326, 25.2, 25.4, 24.97, 22.19, 3059396],
    [20190327, 25.12, 25.27, 25.04, 22.19, 3977900],
    [20190328, 25.0, 25.29, 25.0, 22.19, 2505500],
    [20190329, 25.35, 25.39, 25.14, 22.31, 3086900],
    [20190401, 25.4, 25.64, 25.35, 22.63, 3909300],
    [20190402, 25.68, 26.14, 25.68, 23.05, 5821500],
    [20190403, 26.49, 26.87, 26.49, 23.63, 7041400],
    [20190404, 26.8, 26.98, 26.73, 23.74, 3486700],
    [20190405, 26.85, 26.98, 26.82, 23.85, 2682000],
    [20190408, 27.0, 27.0, 26.77, 23.71, 2903500],
    [20190409, 26.82, 27.05, 26.78, 23.87, 3441500],
    [20190410, 26.99, 27.0, 26.88, 23.85, 2444100],
    [20190411, 27.01, 27.19, 26.89, 23.81, 3085300],
    [20190412, 26.9, 27.01, 26.8, 23.85, 2617100],
    [20190415, 27.07, 27.16, 26.95, 23.88, 2525000],
    [20190416, 27.08, 27.17, 27.07, 24.01, 2821200],
    [20190417, 27.2, 27.49, 27.2, 24.3, 3516300],
    [20190418, 27.44, 27.5, 27.34, 24.23, 2979400],
    [20190422, 27.5, 27.5, 27.33, 24.27, 1614200],
    [20190423, 27.33, 27.46, 27.3, 24.24, 1952500],
    [20190424, 27.38, 27.44, 27.25, 24.2, 2950900],
    [20190425, 27.09, 27.37, 27.09, 24.09, 2908700],
    [20190426, 27.18, 27.43, 27.15, 24.23, 2648400],
    [20190429, 27.69, 28.45, 27.65, 25.11, 6803500],
    [20190430, 28.61, 28.64, 28.06, 24.98, 5381100],
    [20190502, 27.8, 27.86, 27.54, 24.93, 5295200],
    [20190503, 27.65, 27.89, 27.47, 25.05, 3974700],
    [20190506, 26.8, 26.94, 26.48, 23.97, 8041300],
    [20190507, 26.79, 26.95, 26.62, 24.18, 4319140],
    [20190508, 26.55, 26.64, 26.49, 24.01, 4280400],
    [20190509, 26.36, 26.74, 26.35, 24.03, 5204700],
    [20190510, 26.7, 26.9, 26.47, 23.98, 4910300],
    [20190513, 26.44, 26.54, 25.93, 23.49, 5958900],
    [20190514, 25.4, 26.13, 25.4, 23.58, 7740600],
    [20190515, 26.22, 26.38, 26.14, 23.75, 6091100],
    [20190516, 26.35, 26.58, 26.15, 24.01, 3535600],
    [20190517, 26.37, 26.37, 25.88, 23.65, 3839700],
    [20190521, 25.8, 25.95, 25.65, 23.52, 5172600],
    [20190522, 25.66, 25.8, 25.42, 23.23, 3866400],
    [20190523, 25.21, 25.32, 24.98, 23.01, 5830000],
    [20190524, 25.04, 25.4, 25.04, 23.02, 3453700],
    [20190527, 25.15, 25.21, 25.0, 22.9, 3111200],
    [20190528, 25.05, 25.05, 24.82, 22.8, 5872200],
    [20190529, 24.9, 24.95, 24.77, 22.7, 4150800],
    [20190530, 24.7, 24.84, 24.53, 22.48, 5168482],
    [20190531, 24.31, 24.51, 24.18, 22.19, 6258200],
    [20190603, 24.1, 24.17, 24.01, 21.98, 5464300],
    [20190604, 24.15, 24.27, 24.08, 22.17, 4321300],
    [20190606, 24.48, 24.48, 24.09, 22.16, 5093100],
    [20190607, 24.15, 24.39, 24.15, 22.28, 3179000],
    [20190610, 24.46, 24.78, 24.46, 22.4, 3926700],
    [20190611, 24.56, 24.74, 24.56, 22.55, 3632500],
    [20190612, 24.7, 24.99, 24.61, 22.57, 4228300],
    [20190613, 24.64, 24.77, 24.46, 22.55, 3564800],
    [20190614, 24.76, 24.83, 24.65, 22.67, 3381600],
    [20190617, 24.67, 24.92, 24.6, 22.54, 3672800],
    [20190618, 24.63, 24.92, 24.53, 22.66, 3129500],
    [20190619, 25.4, 25.6, 25.34, 23.23, 7338900],
    [20190620, 25.69, 25.98, 25.66, 23.59, 6203100],
    [20190621, 25.74, 25.92, 25.62, 23.68, 5443300],
    [20190624, 25.82, 25.91, 25.74, 23.54, 2855600],
    [20190625, 25.77, 25.84, 25.54, 23.39, 3998000],
    [20190626, 25.5, 25.6, 25.4, 23.28, 3357600],
    [20190627, 25.52, 25.99, 25.5, 23.6, 4825800],
    [20190628, 25.94, 26.1, 25.84, 23.72, 5068200],
    [20190701, 26.22, 26.68, 26.22, 24.3, 5675600],
    [20190702, 26.66, 26.68, 26.25, 24.21, 2811400],
    [20190703, 26.44, 26.48, 26.05, 23.89, 5775900],
    [20190704, 26.21, 26.26, 26.06, 23.81, 2274700],
    [20190705, 26.02, 26.03, 25.41, 23.42, 7533900],
    [20190708, 25.41, 25.49, 25.22, 23.18, 5825400],
    [20190709, 25.45, 25.6, 25.22, 23.13, 4209200],
    [20190710, 25.3, 25.54, 25.3, 23.21, 2639500],
    [20190711, 25.7, 25.9, 25.61, 23.4, 4922700],
    [20190712, 25.77, 25.88, 25.63, 23.55, 2673099],
    [20190715, 25.88, 26.04, 25.77, 23.66, 3047800],
    [20190716, 25.79, 26.08, 25.77, 23.75, 2857300],
    [20190717, 26.0, 26.29, 26.0, 23.99, 5603300],
    [20190718, 26.26, 26.35, 26.1, 24.04, 6041800],
    [20190719, 26.45, 26.67, 26.44, 24.32, 3931300],
    [20190722, 26.6, 26.69, 26.4, 24.27, 2360900],
    [20190723, 26.53, 26.65, 26.51, 24.33, 2552800],
    [20190724, 26.7, 26.83, 26.53, 24.35, 3525500],
    [20190725, 26.8, 26.98, 26.68, 24.59, 2877800],
    [20190726, 26.86, 26.88, 26.7, 24.56, 2608400],
    [20190729, 27.01, 27.04, 26.59, 24.34, 5394400],
    [20190730, 26.5, 26.6, 26.4, 24.2, 4109600],
    [20190731, 26.99, 26.99, 26.41, 24.13, 10900000],
    [20190801, 26.19, 26.81, 26.19, 24.22, 6240500],
    [20190802, 26.31, 26.58, 26.21, 23.98, 8473600],
    [20190805, 26.0, 26.0, 25.27, 23.37, 9639300],
    [20190806, 24.99, 25.1, 24.8, 22.99, 8483700],
    [20190807, 25.0, 25.22, 24.9, 23.18, 4261500],
    [20190808, 24.88, 25.14, 24.81, 23.05, 5129100],
    [20190813, 25.0, 25.0, 24.6, 22.93, 7842800],
    [20190814, 25.0, 25.14, 24.82, 23.1, 4522900],
    [20190815, 24.55, 24.75, 24.5, 22.83, 4572200],
    [20190816, 24.58, 24.76, 24.53, 22.83, 3263700],
    [20190819, 24.7, 24.87, 24.7, 22.87, 2629400],
    [20190820, 24.78, 24.84, 24.7, 22.84, 3174000],
    [20190821, 24.7, 24.75, 24.52, 22.72, 4803600],
    [20190822, 24.7, 24.75, 24.5, 22.73, 2796900],
    [20190823, 24.52, 24.52, 24.36, 22.54, 4793100],
    [20190826, 24.0, 24.29, 23.98, 22.26, 5750200],
    [20190827, 24.11, 24.17, 24.07, 22.34, 6092796],
    [20190828, 24.25, 24.27, 24.02, 22.2, 3140100],
    [20190829, 24.03, 24.24, 23.92, 22.4, 3334400],
    [20190830, 24.43, 24.54, 24.32, 22.67, 4410300],
    [20190902, 24.4, 24.68, 24.24, 22.5, 2325500],
    [20190903, 24.3, 24.39, 24.22, 22.5, 2254800],
    [20190904, 24.35, 24.6, 24.3, 22.68, 6230600],
    [20190905, 24.61, 24.77, 24.56, 22.76, 5073500],
    [20190906, 24.78, 24.92, 24.75, 22.88, 5502700],
    [20190909, 24.82, 24.88, 24.6, 22.89, 1755600],
    [20190910, 24.92, 25.08, 24.92, 23.06, 4040300],
    [20190911, 25.15, 25.41, 25.13, 23.34, 6559900],
    [20190912, 25.4, 25.42, 25.28, 23.45, 3524700],
    [20190913, 25.5, 25.6, 25.41, 23.62, 3803900],
    [20190916, 25.53, 25.55, 25.33, 23.54, 2372500],
    [20190917, 25.55, 25.55, 25.25, 23.38, 2949100],
    [20190918, 25.26, 25.26, 24.96, 23.13, 3527800],
    [20190919, 25.12, 25.26, 24.97, 23.1, 2574679],
    [20190920, 25.11, 25.21, 25.04, 23.24, 4469800],
    [20190923, 25.05, 25.17, 24.9, 23.02, 1879000],
    [20190924, 25.09, 25.12, 24.98, 23.14, 2024700],
    [20190925, 24.84, 24.9, 24.63, 22.86, 4339800],
    [20190926, 24.85, 24.93, 24.79, 22.94, 1924800],
    [20190927, 24.82, 24.92, 24.79, 23.01, 1937300],
    [20190930, 24.65, 25.03, 24.65, 23.1, 2173000],
    [20191001, 25.04, 25.35, 25.0, 23.33, 2617300],
    [20191002, 25.02, 25.1, 24.72, 22.89, 4212700],
    [20191003, 24.5, 24.65, 24.48, 22.71, 3777300],
    [20191004, 24.67, 24.67, 24.4, 22.69, 3017500],
    [20191007, 24.56, 24.84, 24.54, 22.81, 3587900],
    [20191008, 24.7, 24.92, 24.66, 22.88, 3191200],
    [20191009, 24.54, 24.66, 24.54, 22.74, 5232900],
    [20191010, 24.5, 24.76, 24.49, 22.84, 4161300],
    [20191011, 24.86, 25.02, 24.83, 23.01, 5302100],
    [20191014, 25.1, 25.11, 24.99, 23.1, 5083300],
    [20191015, 25.09, 25.1, 24.88, 23.05, 1835600],
    [20191016, 25.07, 25.1, 24.94, 23.15, 5634000],
    [20191017, 24.94, 25.02, 24.66, 23.05, 4234600],
    [20191018, 24.95, 24.97, 24.71, 22.9, 2666900],
    [20191021, 24.7, 25.0, 24.7, 22.9, 1944700],
    [20191022, 24.96, 25.01, 24.85, 23.02, 2646300],
    [20191023, 24.83, 24.92, 24.75, 22.91, 2639900],
    [20191024, 24.96, 25.14, 24.9, 23.18, 3157100],
    [20191025, 25.17, 25.23, 25.02, 23.27, 1865600],
    [20191029, 25.45, 25.65, 25.2, 23.45, 4637200],
    [20191030, 25.5, 25.75, 25.47, 23.74, 5375600],
    [20191031, 25.95, 26.0, 25.75, 24.03, 5535700],
    [20191101, 25.9, 25.96, 25.55, 23.91, 3778300],
    [20191104, 26.0, 26.25, 26.0, 24.15, 3588900],
    [20191105, 26.28, 26.39, 26.15, 24.19, 3211900],
    [20191106, 26.27, 26.6, 26.23, 24.4, 6299000],
    [20191107, 26.4, 26.66, 26.36, 24.64, 4428500],
    [20191108, 26.7, 26.71, 26.45, 24.59, 3318400],
    [20191111, 26.8, 26.8, 26.44, 24.62, 3497300],
    [20191112, 26.64, 26.75, 26.61, 24.7, 3188900],
    [20191113, 26.63, 26.68, 26.46, 24.61, 3607400],
    [20191114, 26.69, 26.69, 26.46, 24.55, 2186800],
    [20191115, 26.64, 26.68, 26.59, 24.6, 3048200],
    [20191118, 26.34, 26.6, 26.3, 24.86, 3018500],
    [20191119, 26.37, 26.52, 26.28, 24.71, 2600700],
    [20191120, 26.34, 26.34, 26.06, 24.47, 2854600],
    [20191121, 25.8, 25.82, 25.6, 23.97, 4726000],
    [20191122, 25.6, 25.89, 25.6, 24.12, 3903200],
    [20191125, 25.96, 26.0, 25.64, 23.98, 3255700],
    [20191126, 25.66, 25.76, 25.61, 24.07, 6609000],
    [20191127, 25.76, 25.78, 25.58, 24.1, 4474100],
    [20191128, 25.8, 25.8, 25.48, 23.86, 2730200],
    [20191129, 25.4, 25.4, 25.18, 23.6, 5461600],
    [20191202, 25.28, 25.32, 25.04, 23.49, 3520500],
    [20191203, 25.01, 25.16, 24.93, 23.35, 6596200],
    [20191204, 24.83, 25.06, 24.8, 23.29, 4958800],
    [20191205, 25.11, 25.11, 24.98, 23.38, 5336200],
    [20191206, 25.11, 25.12, 24.96, 23.48, 4337600],
    [20191209, 25.17, 25.19, 24.97, 23.38, 3832100],
    [20191210, 25.06, 25.07, 24.9, 23.32, 3547100],
    [20191211, 24.98, 25.19, 24.92, 23.41, 4035948],
    [20191212, 25.37, 25.6, 25.32, 23.84, 5233200],
    [20191213, 26.0, 26.0, 25.66, 24.13, 4728800],
    [20191216, 25.64, 25.81, 25.64, 24.02, 2329600],
    [20191217, 25.66, 25.7, 25.51, 23.99, 3012400],
    [20191218, 25.77, 25.84, 25.67, 24.13, 3498000],
    [20191219, 25.83, 25.96, 25.79, 24.25, 3664200],
    [20191220, 26.0, 26.11, 25.85, 24.27, 4244200],
    [20191223, 25.97, 26.0, 25.8, 24.22, 1565900],
    [20191224, 25.98, 26.0, 25.82, 24.29, 914200],
    [20191225, 25.99, 25.99, 25.99, 24.29, 0],
    [20191226, 25.97, 26.0, 25.8, 24.3, 857400],
    [20191227, 25.92, 26.05, 25.89, 24.26, 962500],
    [20191230, 25.9, 25.95, 25.71, 24.14, 1692900],
    [20191231, 25.61, 25.97, 25.61, 24.19, 2217800],
    [20200102, 25.96, 26.12, 25.92, 24.41, 2063600],
    [20200103, 26.17, 26.32, 25.83, 24.3, 4336600],
    [20200106, 25.8, 25.93, 25.8, 24.17, 5928500],
    [20200107, 26.13, 26.19, 25.96, 24.35, 8593000],
    [20200108, 25.8, 25.84, 25.57, 24.05, 14782300],
    [20200109, 25.8, 25.94, 25.77, 24.17, 10474704],
    [20200110, 26.0, 26.12, 25.92, 24.3, 7869500],
    [20200113, 26.16, 26.24, 26.1, 24.4, 2596200],
    [20200114, 26.26, 26.38, 26.23, 24.54, 3857600],
    [20200115, 26.33, 26.39, 26.08, 24.38, 3190700],
    [20200116, 26.05, 26.34, 26.05, 24.61, 4733900],
    [20200117, 26.45, 26.45, 26.32, 24.63, 2347500],
    [20200120, 26.35, 26.4, 26.26, 24.66, 2599400],
    [20200121, 26.28, 26.34, 26.13, 24.58, 2571200],
    [20200122, 26.2, 26.47, 26.2, 24.68, 3178600],
    [20200123, 26.38, 26.43, 26.15, 24.54, 3203300],
    [20200124, 26.37, 26.38, 26.16, 24.49, 1474500],
    [20200128, 25.72, 25.87, 25.46, 24.16, 6997400],
    [20200129, 25.8, 25.97, 25.76, 24.14, 2222100],
    [20200130, 25.88, 25.89, 25.5, 24.01, 3764900],
    [20200131, 25.62, 25.65, 25.2, 23.71, 8167400],
    [20200203, 25.11, 25.2, 24.9, 23.27, 7152943],
    [20200204, 25.0, 25.24, 24.97, 23.51, 5262900],
    [20200205, 25.15, 25.5, 25.11, 23.79, 4331500],
    [20200206, 25.63, 25.72, 25.52, 24.02, 4269000],
    [20200207, 25.57, 25.65, 25.21, 23.66, 5097800],
    [20200210, 24.98, 25.21, 24.87, 23.47, 4696400],
    [20200211, 25.17, 25.36, 25.06, 23.45, 4545400],
    [20200212, 25.09, 25.43, 25.01, 23.76, 7250400],
    [20200213, 25.58, 25.68, 25.42, 23.76, 4775900],
    [20200214, 25.4, 25.62, 25.33, 23.88, 4293700],
    [20200217, 25.5, 25.56, 25.45, 23.82, 2405800],
    [20200218, 25.43, 25.44, 25.21, 23.62, 3334000],
    [20200219, 25.25, 25.45, 25.21, 23.66, 3645000],
    [20200220, 25.31, 25.36, 25.05, 23.46, 6167400],
    [20200221, 25.01, 25.25, 24.96, 23.44, 3809500],
    [20200224, 24.9, 24.97, 24.85, 23.23, 5892900],
    [20200225, 24.88, 25.03, 24.85, 23.3, 3363400],
    [20200226, 24.75, 24.84, 24.65, 23.05, 7032600],
    [20200227, 24.54, 24.83, 24.5, 23.2, 5864700],
    [20200228, 24.4, 24.49, 24.11, 22.54, 11038900],
    [20200302, 24.0, 24.25, 24.0, 22.48, 8352200],
    [20200303, 24.25, 24.45, 24.14, 22.58, 7025400],
    [20200304, 24.08, 24.09, 23.79, 22.35, 10258700],
    [20200305, 23.9, 23.94, 23.57, 22.06, 9867300],
    [20200306, 23.33, 23.34, 22.96, 21.5, 11686900],
    [20200309, 22.3, 22.3, 21.05, 19.77, 20087700],
    [20200310, 20.81, 21.72, 20.5, 20.09, 19486300],
    [20200311, 21.49, 21.77, 21.0, 19.64, 12111100],
    [20200312, 20.66, 20.66, 20.11, 18.88, 14644400],
    [20200313, 19.0, 19.99, 18.87, 18.09, 30162600],
    [20200316, 18.83, 19.18, 18.56, 17.37, 18406300],
    [20200317, 18.18, 18.45, 18.0, 16.83, 23185800],
    [20200318, 18.0, 18.0, 18.0, 16.83, 0],
    [20200319, 18.0, 18.11, 17.36, 16.26, 13586600],
    [20200320, 17.4, 18.25, 17.36, 16.97, 13069400],
    [20200323, 17.12, 17.17, 16.65, 15.78, 11780800],
    [20200324, 17.17, 18.32, 17.17, 17.02, 14731100],
    [20200325, 18.53, 19.44, 18.53, 18.15, 15142800],
    [20200326, 19.42, 19.45, 18.72, 17.82, 9903700],
    [20200327, 19.4, 19.62, 18.93, 17.89, 12082100],
    [20200330, 18.66, 18.82, 18.3, 17.11, 8851200],
    [20200331, 18.44, 18.77, 18.38, 17.36, 11059255],
    [20200401, 18.44, 18.5, 18.07, 16.97, 7061400],
    [20200402, 17.93, 18.45, 17.82, 17.21, 7756900],
    [20200403, 18.43, 18.48, 17.9, 16.75, 7867200],
    [20200406, 18.18, 18.46, 17.95, 17.2, 6169800],
    [20200407, 18.67, 19.11, 18.61, 18.19, 9607600],
    [20200408, 18.84, 18.96, 18.65, 17.92, 4853600],
    [20200409, 19.05, 19.38, 19.05, 18.22, 4939100],
    [20200413, 19.1, 19.4, 18.93, 18.35, 4006500],
    [20200414, 19.28, 20.0, 19.22, 18.9, 8180900],
    [20200415, 20.02, 20.06, 19.32, 18.56, 8019700],
    [20200416, 19.28, 19.67, 19.11, 18.45, 6298300],
    [20200417, 19.8, 19.94, 19.2, 18.35, 9464600],
    [20200420, 19.28, 19.35, 19.01, 18.18, 8387600],
    [20200421, 19.0, 19.08, 18.82, 17.93, 6440300],
    [20200422, 18.73, 18.77, 18.45, 17.84, 8009300],
    [20200423, 18.8, 18.94, 18.74, 17.84, 3985100],
    [20200424, 18.73, 18.85, 18.52, 17.77, 3637100],
    [20200427, 18.6, 19.14, 18.6, 18.08, 4192200],
    [20200428, 19.2, 19.2, 18.87, 18.15, 4905800],
    [20200429, 19.0, 19.2, 18.95, 18.27, 5345000],
    [20200430, 19.87, 20.15, 19.6, 19.0, 17075300],
    [20200504, 19.45, 19.78, 19.32, 18.63, 8607700],
    [20200505, 19.65, 19.81, 19.65, 18.75, 3782700],
    [20200506, 19.7, 19.85, 19.6, 18.79, 5057300],
    [20200508, 19.81, 19.87, 19.65, 18.75, 6063300],
    [20200511, 19.92, 20.0, 19.83, 19.04, 6255500],
    [20200512, 19.4, 19.51, 19.27, 19.05, 6941600],
    [20200513, 19.35, 19.42, 19.26, 18.98, 5214800],
    [20200514, 19.0, 19.17, 18.91, 18.66, 5469300],
    [20200515, 19.04, 19.18, 18.97, 18.7, 5777700],
    [20200518, 19.0, 19.13, 18.97, 18.78, 2955116],
    [20200519, 19.51, 19.82, 19.51, 19.3, 8669700],
    [20200520, 19.59, 19.71, 19.41, 19.19, 4620600],
    [20200521, 19.76, 19.76, 19.43, 19.14, 3343400],
    [20200522, 19.21, 19.34, 19.05, 18.88, 6265000],
    [20200526, 19.2, 19.53, 19.19, 19.13, 5209700],
    [20200527, 19.45, 19.59, 19.26, 19.13, 4627600],
    [20200528, 19.6, 19.83, 19.5, 19.33, 7112600],
    [20200529, 19.42, 19.55, 19.36, 19.16, 7941100],
    [20200601, 19.59, 19.89, 19.54, 19.35, 5955900],
    [20200602, 19.85, 20.21, 19.8, 19.89, 6553900],
    [20200603, 20.51, 21.8, 20.5, 21.46, 13909500],
    [20200604, 22.25, 22.63, 21.68, 21.64, 12048500],
    [20200605, 22.0, 22.28, 21.95, 21.93, 6788516],
    [20200608, 22.45, 23.09, 22.43, 22.73, 10057500],
    [20200609, 23.35, 23.58, 22.6, 22.59, 16205000],
    [20200610, 23.14, 23.35, 22.91, 22.7, 6351300],
    [20200611, 22.9, 22.92, 22.1, 21.8, 9411750],
    [20200612, 21.47, 21.95, 21.07, 21.59, 10633200],
    [20200615, 21.75, 21.78, 21.07, 20.97, 9703900],
    [20200616, 21.75, 22.22, 21.62, 21.32, 7361600],
    [20200617, 21.86, 21.86, 21.35, 21.23, 4229400],
    [20200618, 21.3, 21.64, 21.13, 21.18, 5556000],
    [20200619, 21.32, 21.45, 21.16, 20.83, 8680100],
    [20200622, 21.02, 21.29, 21.02, 20.72, 5492700],
    [20200623, 21.15, 21.21, 20.63, 20.8, 5795300],
    [20200624, 21.2, 21.35, 20.97, 20.77, 3886300],
    [20200625, 20.86, 20.86, 20.5, 20.36, 7606400],
    [20200626, 20.9, 20.95, 20.79, 20.49, 4127200],
    [20200629, 20.6, 20.67, 20.45, 20.2, 5437000],
    [20200630, 20.8, 20.99, 20.77, 20.47, 7045400],
    [20200701, 21.0, 21.26, 20.9, 20.72, 3258400],
    [20200702, 21.22, 21.32, 20.99, 20.95, 3699300],
    [20200703, 21.57, 21.65, 21.39, 21.23, 3516800],
    [20200706, 21.6, 21.98, 21.52, 21.62, 3955700],
    [20200707, 22.2, 22.24, 21.65, 21.33, 4434100],
    [20200708, 21.79, 21.89, 21.6, 21.45, 3369300],
    [20200709, 21.97, 21.97, 21.63, 21.31, 3627530],
    [20200713, 22.1, 22.1, 21.54, 21.2, 2753700],
    [20200714, 21.41, 21.67, 21.34, 21.14, 2961800],
    [20200715, 21.78, 21.99, 21.78, 21.54, 3547400],
    [20200716, 21.88, 21.93, 21.56, 21.26, 3061500],
    [20200717, 21.78, 21.78, 21.38, 21.04, 3217000],
    [20200720, 21.38, 21.48, 21.18, 20.96, 3042400],
    [20200721, 21.58, 21.62, 21.38, 21.06, 3980400],
    [20200722, 21.52, 21.52, 21.03, 20.75, 6064500],
    [20200723, 21.08, 21.15, 21.02, 20.77, 4608000],
    [20200724, 20.98, 20.99, 20.6, 20.32, 6985000],
    [20200727, 20.76, 20.91, 20.46, 20.26, 5486900],
    [20200728, 20.59, 20.72, 20.5, 20.18, 3336700],
    [20200729, 20.58, 20.59, 20.35, 20.08, 3065665],
    [20200730, 20.01, 20.09, 19.53, 19.46, 20568200],
    [20200803, 19.75, 19.75, 19.45, 19.14, 7352600],
    [20200804, 19.7, 19.99, 19.64, 19.38, 4250500],
    [20200805, 19.87, 19.98, 19.59, 19.52, 3414080],
    [20200806, 20.11, 20.56, 20.02, 20.08, 6128100],
    [20200807, 20.52, 20.69, 20.4, 20.28, 8295000],
    [20200811, 20.59, 21.15, 20.55, 20.52, 7732000],
    [20200812, 20.8, 21.18, 20.67, 20.68, 6566300],
    [20200813, 21.3, 21.45, 21.18, 21.08, 5012200],
    [20200814, 21.12, 21.3, 20.98, 20.91, 3990200],
    [20200817, 21.0, 21.3, 20.9, 20.85, 2691800],
    [20200818, 20.82, 20.95, 20.64, 20.59, 5587800],
    [20200819, 20.55, 20.93, 20.53, 20.73, 2775800],
    [20200820, 20.7, 20.85, 20.51, 20.57, 5086200],
    [20200821, 20.98, 20.98, 20.66, 20.58, 2989900],
    [20200824, 20.86, 20.86, 20.69, 20.64, 1833100],
    [20200825, 20.78, 21.11, 20.74, 20.84, 4256500],
    [20200826, 20.88, 20.94, 20.6, 20.53, 3316900],
    [20200827, 20.6, 20.73, 20.38, 20.31, 4387100],
    [20200828, 20.7, 21.07, 20.61, 20.61, 5875000],
    [20200831, 21.02, 21.15, 20.76, 20.72, 5169500],
    [20200901, 20.7, 20.96, 20.65, 20.72, 2799500],
    [20200902, 20.95, 20.99, 20.61, 20.72, 2867000],
    [20200903, 20.81, 20.88, 20.55, 20.61, 4060000],
    [20200904, 20.46, 20.7, 20.4, 20.53, 4536500],
    [20200907, 20.6, 20.82, 20.55, 20.57, 1915800],
    [20200908, 20.76, 20.92, 20.65, 20.5, 3016800],
    [20200909, 20.5, 20.65, 20.4, 20.37, 6611959],
    [20200910, 20.65, 20.72, 20.45, 20.39, 2995400],
    [20200911, 20.4, 20.59, 20.4, 20.36, 2986800],
    [20200914, 20.6, 20.68, 20.44, 20.31, 2676200],
    [20200915, 20.43, 20.63, 20.31, 20.2, 5005100],
    [20200916, 20.35, 20.39, 20.23, 20.14, 3228000],
    [20200917, 20.25, 20.29, 20.02, 19.87, 5715992],
    [20200918, 20.14, 20.15, 19.97, 19.9, 5606000],
    [20200921, 20.05, 20.29, 19.97, 19.84, 4410000],
    [20200922, 19.74, 19.84, 19.62, 19.59, 8427000],
    [20200923, 19.74, 19.93, 19.63, 19.74, 4210700],
    [20200924, 19.8, 19.93, 19.74, 19.65, 3871100],
    [20200925, 19.8, 20.03, 19.8, 19.86, 3238800],
    [20200928, 19.97, 20.27, 19.83, 20.07, 3360000],
    [20200929, 20.3, 20.4, 19.97, 19.83, 3823800],
    [20200930, 20.17, 20.17, 19.91, 19.76, 4878200],
    [20201001, 20.02, 20.42, 20.02, 20.25, 4907700],
    [20201002, 20.33, 20.41, 20.04, 20.22, 3550700],
    [20201005, 20.61, 20.64, 20.47, 20.43, 3764500],
    [20201006, 20.6, 20.78, 20.6, 20.56, 4107400],
    [20201007, 20.65, 20.88, 20.55, 20.72, 4647600],
    [20201008, 20.95, 21.04, 20.8, 20.86, 4237800],
    [20201009, 21.1, 21.2, 21.04, 20.89, 4448200],
    [20201012, 21.0, 21.42, 21.0, 21.24, 5736900],
    [20201013, 21.48, 21.65, 21.35, 21.43, 4851100],
    [20201014, 21.46, 21.48, 21.14, 21.16, 3623300],
    [20201015, 21.11, 21.36, 21.02, 20.91, 3391300],
    [20201016, 21.02, 21.41, 21.02, 21.23, 3706900],
    [20201019, 21.52, 21.62, 21.45, 21.41, 3116000],
    [20201020, 21.57, 21.58, 21.24, 21.14, 3096800],
    [20201021, 21.35, 21.52, 21.22, 21.09, 3479600],
    [20201022, 21.22, 21.44, 21.15, 21.28, 2876200],
    [20201023, 21.56, 21.62, 21.42, 21.39, 4020800],
    [20201026, 21.55, 21.55, 21.27, 21.14, 1878800],
    [20201027, 21.21, 21.34, 21.1, 21.16, 3294400],
    [20201028, 21.1, 21.18, 20.9, 20.75, 4233200],
    [20201029, 20.65, 20.69, 20.53, 20.41, 5750300],
    [20201030, 20.4, 20.58, 20.31, 20.2, 7438700],
    [20201102, 20.3, 20.7, 20.25, 20.48, 3469700],
    [20201103, 20.8, 21.43, 20.8, 21.27, 6054700],
    [20201104, 21.59, 21.64, 21.21, 21.39, 5965600],
    [20201105, 21.83, 22.43, 21.81, 22.26, 10979800],
    [20201106, 22.51, 22.58, 22.17, 22.32, 5894800],
    [20201109, 22.72, 23.0, 22.72, 22.78, 5409200],
    [20201110, 24.5, 24.5, 23.8, 24.22, 18267200],
    [20201111, 24.39, 24.4, 24.02, 24.22, 9380300],
    [20201112, 24.24, 24.36, 23.81, 23.97, 6471900],
    [20201113, 23.85, 23.94, 23.66, 23.88, 4826000],
    [20201116, 24.0, 24.28, 23.96, 24.22, 4072300],
    [20201117, 24.5, 24.65, 24.46, 24.65, 7749400],
    [20201118, 24.67, 24.89, 24.56, 24.63, 7025300],
    [20201119, 24.26, 24.6, 24.2, 24.42, 5704600],
    [20201120, 24.5, 24.6, 24.36, 24.6, 4610800],
    [20201123, 24.89, 25.16, 24.83, 25.07, 7446010],
    [20201124, 25.5, 25.6, 25.17, 25.6, 7447190],
    [20201125, 25.8, 25.98, 25.59, 25.68, 11433800],
    [20201126, 25.5, 25.54, 25.38, 25.5, 5030700],
    [20201127, 25.49, 25.75, 25.39, 25.68, 4099000],
    [20201130, 25.8, 25.8, 25.11, 25.2, 13335554],
    [20201201, 25.1, 25.2, 24.87, 25.19, 5535600],
    [20201202, 25.17, 25.41, 25.09, 25.32, 3181400],
    [20201203, 25.32, 25.59, 25.09, 25.58, 3625800],
    [20201204, 25.7, 25.8, 25.62, 25.66, 3977300],
    [20201207, 25.36, 25.52, 25.2, 25.26, 4059600],
    [20201208, 25.06, 25.2, 24.93, 25.01, 3579500],
    [20201209, 24.98, 25.48, 24.98, 25.45, 4259200],
    [20201210, 25.18, 25.25, 25.05, 25.05, 3450800],
    [20201211, 25.16, 25.38, 25.03, 25.06, 5686000],
    [20201214, 25.37, 25.57, 25.36, 25.45, 3565300],
    [20201215, 25.7, 25.71, 25.27, 25.46, 5196500],
    [20201216, 25.6, 25.63, 25.46, 25.56, 5248000],
    [20201217, 25.55, 25.6, 25.31, 25.37, 2811800],
    [20201218, 25.28, 25.42, 25.06, 25.09, 7095100],
    [20201221, 25.15, 25.3, 24.92, 25.2, 5545900],
    [20201222, 25.15, 25.19, 24.71, 25.05, 3741100],
    [20201223, 24.8, 25.07, 24.72, 25.07, 2220600],
    [20201228, 25.17, 25.24, 25.01, 25.13, 1838800],
    [20201229, 25.24, 25.27, 25.08, 25.2, 2177000],
    [20201230, 25.25, 25.37, 25.11, 25.23, 3715400],
    [20210104, 25.13, 25.34, 25.01, 25.34, 2156614],
    [20210105, 25.22, 25.35, 25.09, 25.35, 2076800],
    [20210106, 25.3, 25.35, 25.07, 25.18, 3807600],
    [20210107, 25.68, 26.18, 25.63, 26.05, 11938600],
    [20210108, 26.55, 27.47, 26.5, 27.42, 14510800],
    [20210111, 27.39, 27.39, 26.92, 26.92, 5528700],
    [20210112, 26.79, 26.86, 26.52, 26.73, 4847200],
    [20210113, 27.0, 27.1, 26.72, 26.76, 3740200],
    [20210114, 26.9, 26.99, 26.77, 26.99, 2521200],
]

from pprint import pprint

# IMPORTANCE !!------------------------------------------------------------
# pprint is a very useful library, it helps you Pretty Print your variable
# You need to include the following line in the front
# from pprint import pprint
#
# the 1st pprint is the module name
# the 2nd pprint is the method name
# -------------------------------------------------------------------------


'''
Task introduction:
SMA_5(Simple Moving Average of 5 days) is the arithmetic mean of the past 5 days' CLOSE prices.
SMA_30(Simple Moving Average of 30 days) is the arithmetic mean of the past 30 days' CLOSE prices.
For example:
    [20201230, 25.25, 25.37, 25.11, 25.23, 3715400],
    [20210104, 25.13, 25.34, 25.01, 25.34, 2156614],
    [20210105, 25.22, 25.35, 25.09, 25.35, 2076800],
    [20210106, 25.3, 25.35, 25.07, 25.18, 3807600],
    [20210107, 25.68, 26.18, 25.63, 26.05, 11938600],  SMA_5 is (25.23 + 25.34 + 25.35 + 25.18 + 26.05) / 5 = 25.43, CLOSE price for today is 26.05 -> Conclusion: CLOSE is above SMA_5
    [20210108, 26.55, 27.47, 26.5, 27.42, 14510800],   SMA_5 is (25.34 + 25.35 + 25.18 + 26.05 + 27.42) / 5 = 25.87, CLOSE price for today is 27.42 -> Conclusion: CLOSE is above SMA_5
    [20210111, 27.39, 27.39, 26.92, 26.92, 5528700],
    [20210112, 26.79, 26.86, 26.52, 26.73, 4847200],
    [20210113, 27.0, 27.1, 26.72, 26.76, 3740200],
    [20210114, 26.9, 26.99, 26.77, 26.99, 2521200],
Requirment:
1) Calculate SMA_5 for each day, the initial 4 days do not have enough previous CLOSE prices, so there is no SMA_5 for them.
2) Append the SMA_5 value to the end of day_trade_data list.
3) Loop from the beginning:
   As soon as CLOSE price of the day goes up above SMA_5, print TRADE_DATE / CLOSE / SMA_5 of the day.
   As soon as CLOSE price of the day goes down below SMA_5, print TRADE_DATE / CLOSE / SMA_5 of the day.
'''
'''
logic:
Observation 1:
SMA_5 is the arithmetic mean of the past 5 days' CLOSE.
Conclusion 1:
I need to collect the past 4 days' CLOSE + today's CLOSE, then calculate the arithmetic mean.
To do list, I can simply put the CLOSE into a list - close_price_list
Then sum(close_price_list) / 5 is the SMA_5 value.
Observation 2:
Because I need to calculate the SMA_5 for each list in list trade_data
Conclusion 2:
So I need to put the core logic in a loop.
When len(close_price_list) < 5, for example, the first 4 days, then I cannot calculate SMA_5
When I move on to next day, I need to remove the 1st day's CLOSE, append the new day's CLOSE.
So that len(close_price_list) is ALWAYS 5.
    1) append(today's CLOSE) to add today's CLOSE
    2) pop(0) to remove the 1st day's CLOSE
    3) sma5 = sum(close_price_list) / 5
'''
# this variable holds the past 5 days' CLOSE prices
close_price_list = []

# As I need to calculate the SMA_5 for all day_trade_data, so I need to loop one by one
for day_trade_data in trade_data:

    #Step 1) append today's CLOSE to close_price_list
    close_price_list.append(day_trade_data[4]) # CLOSE price is at index 4 of day_trade_data list. For example: [20210114, 26.9, 26.99, 26.77, 26.99, 2521200]

    #Step 2) I need to check whether close_price_list's size is 5 or not
    if len(close_price_list) == 5:

        #Step 2.1) calculate the arithmetic mean of the last 5 days' CLOSE
        sma5 = round(sum(close_price_list) / 5, 2)

        #Step 2.2) append the sma5 to the end of today's day_trade_data
        day_trade_data.append(sma5)

        #Step 2.3) Remove the 1st CLOSE price in close_price_list, as it is useless for tomorrow's SMA5.
        #After this step, the len(close_price_list) becomes 4 again.
        close_price_list.pop(0)






'''
Till now, the 1st and 2nd requirement are done!
The 3rd requirement is to print the CLOSE/SMA5 Crossing Signal.
What is Crossing signal? 
When CLOSE price goes from below to above SMA5, that is a 'Golden Cross'.
When CLOSE price goes from above to below SMA5, that is a 'Death Cross'.
Reference: https://www.investopedia.com/terms/g/goldencross.asp
Observation 1:
I need to find all Crossing signals - Golden Cross / Death Cross
Conclusion 1:
I need to loop from day 1 till last day
Observation 2:
Crossing signal appears when CLOSE changes its position from below SMA5 to above SMA5, or vice versa.
Conclusion 2:
So I need 2 str variables - close_position_old vs close_position_new, their value can be 'ABOVE' or 'BELOW' or ''(for the first 4 days)
So I can compare the 2 variables, then I can generate Crossing signals.
'''

close_position_old = ''
close_position_new = ''

for day_trade_data in trade_data:

    # the first 4 days don't have SMA5, so they only have 6 values in the list -  [20201002, 20.33, 20.41, 20.04, 20.22, 3550700, 20.03],
    if len(day_trade_data) != 7:
        continue

    # Here is a sample data [20201002, 20.33, 20.41, 20.04, 20.22, 3550700, 20.03],
    # day_trade_data[4] is CLOSE price
    # day_trade_data[6] is SMA5
    # So I need to compare day_trade_data[4] vs day_trade_data[6]

    # Now I am going to change close_position_new to remember where CLOSE is, is 'BELOW' SMA5 or 'ABOVE' SMA5.
    # Before that, I need to assign close_position_new to close_position_old
    close_position_old = close_position_new

    if day_trade_data[4] < day_trade_data[6]:
        close_position_new = 'BELOW'
    elif day_trade_data[4] > day_trade_data[6]:
        close_position_new = 'ABOVE'

    if close_position_old == 'BELOW' and close_position_new == 'ABOVE':
        day_trade_data.append('Golden Cross')
        print(f"CLOSE price {day_trade_data[4]} goes ABOVE SMA5 {day_trade_data[6]} on date {day_trade_data[0]}. BUY!")
    elif close_position_old == 'ABOVE' and close_position_new == 'BELOW':
        day_trade_data.append('Death Cross')
        print(f"CLOSE price {day_trade_data[4]} goes BELOW SMA5 {day_trade_data[6]} on date {day_trade_data[0]}. SELL!")

pprint(trade_data)



# Let's assume initially, we have 0 dollars and 1000 shares of DBS stock.
cash_amount = 0
stock_shares = 1000
total_asset = cash_amount + stock_shares * trade_data[0][4]
print(f"Today: {trade_data[0][0]}. Total asset: {total_asset:.2f}. Cash amount: ${cash_amount:.2f}, stock: {stock_shares} shares.")


for day_trade_data in trade_data:

    if len(day_trade_data) != 8:
        continue

    if "Golden Cross" == day_trade_data[7]: # Let's buy stock
        stock_shares += 1000
        cash_amount -= day_trade_data[4] * 1000

    elif "Death Cross" == day_trade_data[7]: # Let's sell stock
        stock_shares -= 1000
        cash_amount += day_trade_data[4] * 1000

    total_asset = cash_amount + stock_shares * day_trade_data[4]
    print(f"Today: {day_trade_data[0]}. Total asset: {total_asset:.2f}. Cash amount: ${cash_amount:.2f}, stock: {stock_shares} shares.")

